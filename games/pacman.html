<html>

<head>
    <title> Pacman Game </title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>


</head>

<body>

    <div id='container'>

        <div id='world'></div>
        <div id='score'></div>
        <div id='lifescontainer'></div>
        

    </div>
    
    <script type="text/javascript">

        var myVar

        var world = [
            [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,2,2,2,2,2,2,2,2],
            [2, 1, 1, 1, 2,2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,1,1,1,1,1,2],
            [2, 3, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2,2,2,1,2,1,2,3,2],
            [2, 1, 2, 2, 2, 1, 2, 2, 2, 1, 2, 2, 2, 1, 2, 2, 2, 1, 2,2,2,1,2,1,2,1,2],
            [2, 1, 2, 2, 2, 1, 2, 2, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1,1,2,1,2,1,2,1,2],
            [2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2,1,2,1,2,1,2,1,2],
            [2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2,1,2,1,2,1,2,1,2],
            [2, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 2, 1, 2, 2, 1, 2, 2,1,1,1,2,1,1,1,2],
            [2, 1, 2, 4, 2, 1, 2, 2, 2, 1, 2, 2, 2, 1, 1, 1, 1, 2, 2,2,2,1,2,2,2,1,2],
            [2, 1, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 1,1,1,1,2,2,2,1,2],
            [2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2,2,2,1,2,1,1,1,2],
            [2, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 3, 2, 1, 1,1,1,1,1,1,2,2,2],
            [2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2,2,2,1,2,1,2,2,2],
            [2, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,1,1,1,1,3,2],
            [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,2,2,2,2,2,2,2,2],
        ];   

        var pacman= {

            x:3,
            y:8
        }

        var ghost={

            x:7,
            y:7
        }

        var score = 0

        var lifescontainer=4

        function displayWorld() {

            var output = ""

            for (var i = 0; i < world.length; i++) {

                output += '\n <div class="row">';

                for (var j = 0; j < world[i].length; j++) {

                    if (world[i][j] == 2) {
                        output += '\n\t<div class="brick"></div>';
                    }
                    if (world[i][j] == 1) {
                        output += '\n\t<div class="coin"></div>';
                    }
                    if (world[i][j] == 0) {
                        output += '\n\t<div class="empty"></div>';
                    }
                    if (world[i][j] ==3){
                        output += '\n\t<div class="cherry"></div>';
                    }
                    if (world[i][j] == 4) {                       
                        output += '\n\t<div class="pacmanRight"></div>';
                    }
                    if (world[i][j] == 5) {                       
                        output += '\n\t<div class="pacmanLeft"></div>';
                    }
                    if (world[i][j] == 6) {                      
                        output += '\n\t<div class="pacmanUp"></div>';
                    }
                    if (world[i][j] == 7) {                       
                        output += '\n\t<div class="pacmanDown"></div>';
                    }
                    if (world[i][j] == 8) {                      
                        output += '\n\t<div class="ghost"></div>';
                    }
                }
                output += '\n </div>';
            }
            document.getElementById('world').innerHTML = output;
        }

        function displayScore(){
            document.getElementById('score').innerHTML = score;

        }

        function displayLifes(){
        
            document.getElementById('lifescontainer').innerHTML = lifescontainer;    
          
         }         

        displayWorld();
        displayWorld();

        displayScore();
        displayLifes();

        function moveGhost(a){
            

            //Limitaciones movimientos fantasma y ladrillos

            if(a==1){

                if(world[ghost.y][ghost.x+1]==2){

                    number=(Math.floor(Math.random() * 3)+1)
                    
                    //izquierda
                    if (number==1){
                        moveGhost(2);
                    }
                    //abajo
                    else if (number==2){
                        moveGhost(4);
                    }

                    //arriba
                    else if (number==3){
                       moveGhost(3);
                    }

                }

                else{
                    world[ghost.y][ghost.x+1]=8
                    world[ghost.y][ghost.x]=1
                    ghost.x++
                    
                    
                }
            }

            if(a==2){
                if(world[ghost.y][ghost.x-1]==2){
                    number=(Math.floor(Math.random() * 3)+1)
                    
                    //derecha
                    if (number==1){
                        moveGhost(1);
                    }
                    //abajo
                    else if (number==2){
                        moveGhost(4);
                    }
                    //arriba
                    else if (number==3){
                        moveGhost(3);
                    }
                }

                else{
                    world[ghost.y][ghost.x-1]=8
                    world[ghost.y][ghost.x]=1
                    ghost.x--
                   
                }
            }              

            if(a==3){
                if(world[ghost.y-1][ghost.x]==2){
                    number=(Math.floor(Math.random() * 3)+1)
                    
                    //derecha
                    if (number==1){
                        moveGhost(1);
                    }
                    //izquierda
                    else if (number==2){
                        moveGhost(2);
                    }
                    //abajo
                    else if (number==3){
                        moveGhost(4);
                    }
                }          

                else{
                    world[ghost.y-1][ghost.x]=8
                    world[ghost.y][ghost.x]=1
                    ghost.y--
                   
                }
            }

            if(a==4){
                if(world[ghost.y+1][ghost.x]==2){
                    number=(Math.floor(Math.random() * 3)+1)
                    
                    //derecha
                    if (number==1){
                        moveGhost(1);
                    }
                    //izquierda
                    else if (number==2){
                        moveGhost(2);
                    }
                    //arriba
                    else if (number==3){
                        moveGhost(3);
                    }
                }

                else{
                    world[ghost.y+1][ghost.x]=8
                    world[ghost.y][ghost.x]=1
                    ghost.y++
                    
                }
            } 
            
            displayWorld();
        }

        $(document).on('keypress', function (e) {
            //move to right (with D)
            if (e.which == 68) {

                var random=(Math.floor(Math.random() * 4) + 1)
                moveGhost(random);


                if(world[pacman.y][pacman.x+1]!=2){

                    if(world[pacman.y][pacman.x+1]==1){
                        score=score+10
                    }

                    if(world[pacman.y][pacman.x+1]==3){
                        score=score+50
                    }

                    console.log("Posicion pacman.x: "+pacman.x+" posicion pacman.y: "+pacman.y);
                    console.log("Posicion ghost.x: "+ghost.x+" posicionghost.y: "+ghost.y);

                    if(pacman.x==ghost.x && pacman.y==ghost.y){
                        console.log("choque con un fantasma")
                        lifescontainer=lifescontainer-1
                        displayLifes();
                        pacman.x=3
                        pacman.y=8
                        world[pacman.y][pacman.x] = 4
                    }

                    world[pacman.y][pacman.x] = 0
                    pacman.x += 1
                    world[pacman.y][pacman.x] = 4

                    

                    displayWorld();
                    displayScore();
                    

                }                                
            }
            //move to left (with A)
            else if (e.which == 65) {

                var random=(Math.floor(Math.random() * 4) + 1)
                moveGhost(random);

                if(world[pacman.y][pacman.x-1]!=2){

                    if(world[pacman.y][pacman.x-1]==1){
                        score=score+10
                    }

                    if(world[pacman.y][pacman.x-1]==3){
                        score=score+50
                    }

                    
                    console.log("Posicion pacman.x: "+pacman.x+" posicion pacman.y: "+pacman.y);
                    console.log("Posicion ghost.x: "+ghost.x+" posicionghost.y: "+ghost.y);

                    
                    if(pacman.x==ghost.x && pacman.y==ghost.y){
                        console.log("choque con un fantasma")
                        lifescontainer=lifescontainer-1
                        displayWorld();
                        displayScore();
                        displayLifes();
                        pacman.x=3
                        pacman.y=8
                        world[pacman.y][pacman.x] = 4

                    }else{
                        
                        world[pacman.y][pacman.x] = 0
                        pacman.x += -1
                        world[pacman.y][pacman.x] = 5
                        displayWorld();
                        displayScore();
                        displayLifes();

                    }

                }                
            }
            //move to up (with W)
            else if (e.which == 87) {

                var random=(Math.floor(Math.random() * 4) + 1)
                moveGhost(random);               

                if(world[pacman.y-1][pacman.x]!=2){

                    if(world[pacman.y-1][pacman.x]==1){
                        score=score+10
                    }

                    if(world[pacman.y-1][pacman.x]==3){
                        score=score+50
                    }

                    console.log("Posicion pacman.x: "+pacman.x+" posicion pacman.y: "+pacman.y);
                    console.log("Posicion ghost.x: "+ghost.x+" posicionghost.y: "+ghost.y);

                    if(pacman.x==ghost.x && pacman.y==ghost.y){
                        console.log("choque con un fantasma")
                        lifescontainer=lifescontainer-1
                        displayLifes();
                        pacman.x=3
                        pacman.y=8
                        world[pacman.y][pacman.x] = 4
                    }

                    world[pacman.y][pacman.x] = 0
                    pacman.y += -1
                    world[pacman.y][pacman.x] = 6

                    displayWorld();
                    displayScore();
                }
            }

            //move to down (with S)
            else if (e.which == 83) {

                var random=(Math.floor(Math.random() * 4) + 1)
                moveGhost(random);

                if(world[pacman.y+1][pacman.x]!=2){

                    if(world[pacman.y+1][pacman.x]==1){
                        score=score+10
                    }

                    if(world[pacman.y+1][pacman.x]==3){
                        score=score+50
                    }

                    console.log("Posicion pacman.x: "+pacman.x+" posicion pacman.y: "+pacman.y);
                    console.log("Posicion ghost.x: "+ghost.x+" posicionghost.y: "+ghost.y);

                    if(pacman.x==ghost.x && pacman.y==ghost.y){
                        console.log("choque con un fantasma")
                        lifescontainer=lifescontainer-1
                        displayLifes();
                        pacman.x=3
                        pacman.y=8
                        world[pacman.y][pacman.x] = 4
                    }
         
                    world[pacman.y][pacman.x] = 0
                    pacman.y += 1
                    world[pacman.y][pacman.x] = 7

                    displayWorld();
                    displayScore();
                }

            }
        });

    </script>


</body>

</html>